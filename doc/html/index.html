<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QtMark JSON Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">QtMark JSON Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This JSON library provides several benefits over the standard JSON library the comes with Qt.</p>
<h3>Managed Pointers</h3>
<dl class="section note"><dt>Note</dt><dd>Currently QMPointer is a redefinition of QSharedPointer as we have not yet upstreamed QMPointer. Once the upstream is complete, the only change that will be needed is to include the QtMark Pointer Library.</dd></dl>
<p>When using this library, you will notice that everything is stored using managed QMPointers. This is done intentially, and you should not attempt to use the Qt Mark JSON classes without storing them in a QMPointer as each class prohibits by-value copying. Although storing these classes in managed QMPointers adds an extra level of complexity, it also provides a lot of benefits. The most notible being the following:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> object1 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> object2 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> object3 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"></div><div class="line">object1-&gt;insert(<span class="stringliteral">&quot;object2&quot;</span>, object2);</div><div class="line">object2-&gt;insert(<span class="stringliteral">&quot;object3&quot;</span>, object3);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;boolean&quot;</span>, <span class="keyword">true</span>);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;double&quot;</span>, 4.8);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;string&quot;</span>, <span class="stringliteral">&quot;Hello World&quot;</span>);</div></div><!-- fragment --><p>In this example, you could pass 'object3' easily to any function, and manipulate it from more than one place as needed. It is also possible to use a JSON value in more than one place in a JSON tree at the same time:</p>
<div class="fragment"><div class="line">object1-&gt;insert(<span class="stringliteral">&quot;object2&quot;</span>, object2);</div><div class="line">object1-&gt;insert(<span class="stringliteral">&quot;object3&quot;</span>, object3);</div><div class="line">object2-&gt;insert(<span class="stringliteral">&quot;object3&quot;</span>, object3);</div></div><!-- fragment --><p>You can also save off specific portions of a tree:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> object1 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> object2 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> object3 = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> value1 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(object1));</div><div class="line"><span class="keyword">auto</span> value2 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(object2));</div><div class="line"><span class="keyword">auto</span> value3 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(object3));</div><div class="line"></div><div class="line">object1-&gt;insert(<span class="stringliteral">&quot;object2&quot;</span>, object2);</div><div class="line">object2-&gt;insert(<span class="stringliteral">&quot;object3&quot;</span>, object3);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;boolean&quot;</span>, <span class="keyword">true</span>);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;double&quot;</span>, 4.8);</div><div class="line">object3-&gt;insert(<span class="stringliteral">&quot;string&quot;</span>, <span class="stringliteral">&quot;Hello World&quot;</span>);</div><div class="line"></div><div class="line">qDebug() &lt;&lt; value1-&gt;toJson();</div><div class="line">qDebug() &lt;&lt; value2-&gt;toJson();</div><div class="line">qDebug() &lt;&lt; value3-&gt;toJson();</div></div><!-- fragment --><h3>Complex Types</h3>
<p>Unlike Qt's native JSON support, the QtMark JSON Library has support for custom types. Actually, you can store anything in a <a class="el" href="class_q_m_json_value.html">QMJsonValue</a> that you want. This provides the ability to use <a class="el" href="class_q_m_json_array.html">QMJsonArray</a> and <a class="el" href="class_q_m_json_object.html">QMJsonObject</a> as a set of data structures that support varying data types in C++. That is with most C++ data structures, you can only store one type of data in the structure, but with this library, you can store anything you want, in whatever combination you can think of:</p>
<div class="fragment"><div class="line">[1, 2, 3, 4, 5]</div><div class="line"></div><div class="line"><span class="comment">// vs</span></div><div class="line"></div><div class="line">[QSize, 4.8, <span class="keyword">true</span>, <span class="stringliteral">&quot;Hello&quot;</span>, MyClass]</div></div><!-- fragment --><p>The compiler is likely to complain about a non-JSON type if it doesn't contain the following:</p>
<ul>
<li>Default constructor</li>
<li>Equals operator</li>
<li>QDebug Overload</li>
</ul>
<p>If you attempt to use toJson or fromJson with a non-JSON type, you will also need to provide overloads to <a class="el" href="class_q_m_json_type.html#a133ec450fe8dc75231a4d4430c714aac">QMJsonType::toComplexJson</a> and <a class="el" href="class_q_m_json_type.html#a439dcf8413ff8e3a12dde8c0e3966301">QMJsonType::fromComplexJson</a>. These functions are used to tell the JSON library how to marshal / unmarshal the non-JSON type into standard JSON. Non-standard types are stored as JSON objects, with a special field in the object called 'qmjsontype' that tells the library which <a class="el" href="class_q_m_json_type.html#a439dcf8413ff8e3a12dde8c0e3966301">QMJsonType::fromComplexJson</a> function to use when an object with this key is encountered. <a class="el" href="class_q_m_json_type.html#a439dcf8413ff8e3a12dde8c0e3966301">QMJsonType::fromComplexJson</a> functions are registered with the library using <a class="el" href="class_q_m_json_value.html#a1e3b47a919634655bf10f5c4fa8622cf">QMJsonValue::registerFromComplexJson</a>.</p>
<p>For a complete exmaple, see <a class="el" href="main_8cpp.html">main.cpp</a>, <a class="el" href="qmjsontype__qsize_8cpp.html">qmjsontype_qsize.cpp</a> and <a class="el" href="qmjsontype__qrect_8cpp.html">qmjsontype_qrect.cpp</a></p>
<h3>Signals / Slots</h3>
<p>Since all of the JSON classes in the QtMark JSON Library use managed QMPointers, they can safely inherit QObject providing access to signals and slots. <a class="el" href="class_q_m_json_value.html">QMJsonValue</a>, <a class="el" href="class_q_m_json_array.html">QMJsonArray</a> and <a class="el" href="class_q_m_json_object.html">QMJsonObject</a> provide the following signals:</p>
<ul>
<li>valueChanged</li>
<li>itemAdded</li>
<li>itemRemoved</li>
</ul>
<p>With signals and slots, it's possible trigger code when changes to a JSON tree occur, providing a simple means for implementing MVC architectures with this JSON library.</p>
<h3>Convenience Functions</h3>
<p>This library comes with a lot of convenience functions designed to make dealing with the API easier on developers. For example, JSON normally only stores doubles for numbers. This is because most integer types can be stored as a double. The problem is this leaves a lot of type casting to the programmer. If you wanted to add an int to a <a class="el" href="class_q_m_json_value.html">QMJsonValue</a>, you would need to first case the int to a double:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> value1 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>((<span class="keywordtype">double</span>)4));</div><div class="line"></div><div class="line"><span class="comment">// vs</span></div><div class="line"></div><div class="line"><span class="keyword">auto</span> value2 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(4));</div></div><!-- fragment --><p>These automatic type conversions are provided for all number types, as well as standard C style strings. These type conversions also work with <a class="el" href="class_q_m_json_array.html">QMJsonArray</a> and <a class="el" href="class_q_m_json_object.html">QMJsonObject</a>'s insertion functions. <a class="el" href="class_q_m_json_array.html">QMJsonArray</a> and <a class="el" href="class_q_m_json_object.html">QMJsonObject</a> also provide convenience functions for accessing QMJsonValues. For example, the following are equivlant:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> <span class="keywordtype">object</span> = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keywordtype">object</span>-&gt;insert(<span class="stringliteral">&quot;key1&quot;</span>, 4.8);</div><div class="line"></div><div class="line">qDebug() &lt;&lt; <span class="keywordtype">object</span>-&gt;value(<span class="stringliteral">&quot;key1&quot;</span>)-&gt;toDouble(); <span class="comment">// 4.8</span></div><div class="line">qDebug() &lt;&lt; <span class="keywordtype">object</span>-&gt;toDouble(<span class="stringliteral">&quot;key1&quot;</span>); <span class="comment">// 4.8</span></div></div><!-- fragment --><p>The same works for <a class="el" href="class_q_m_json_array.html">QMJsonArray</a>, and we even provided something similar for <a class="el" href="class_q_m_json_value.html">QMJsonValue</a></p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> <span class="keywordtype">object</span> = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> value = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(<span class="keywordtype">object</span>));</div><div class="line"><span class="keywordtype">object</span>-&gt;insert(<span class="stringliteral">&quot;key1&quot;</span>, 4.8);</div><div class="line"></div><div class="line">qDebug() &lt;&lt; value-&gt;toObject()-&gt;value(<span class="stringliteral">&quot;key1&quot;</span>); <span class="comment">// QMJsonValue(4.8)</span></div><div class="line">qDebug() &lt;&lt; value-&gt;value(<span class="stringliteral">&quot;key1&quot;</span>); <span class="comment">// QMJsonValue(4.8)</span></div></div><!-- fragment --><h3>To / From JSON</h3>
<p>It's likely that at some point, your going to want to convert your JSON to a JSON string. This can be done by either using an existing <a class="el" href="class_q_m_json_value.html">QMJsonValue</a>, or wrapping what you want to convert to JSON (e.g. a <a class="el" href="class_q_m_json_object.html">QMJsonObject</a> or maybe a non-standard JSON type like QSize) with a <a class="el" href="class_q_m_json_value.html">QMJsonValue</a>, and then running <a class="el" href="class_q_m_json_value.html#a21d517f02d607c282bbd0d6cc6ae1bc1">QMJsonValue::toJson</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> <span class="keywordtype">object</span> = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> value1 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(<span class="keywordtype">object</span>));</div><div class="line"><span class="keyword">auto</span> value2 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(QSize(4, 8)));</div><div class="line"></div><div class="line"><span class="keywordtype">object</span>-&gt;insert(<span class="stringliteral">&quot;key1&quot;</span>, 4.8);</div><div class="line"></div><div class="line">qDebug() &lt;&lt; value1-&gt;toJson(<a class="code" href="qmjsontype_8h.html#a497c80a5fccb8e63847bf518781be30da68a97f9a51fd9868a5fcc953f179c5db">QMJsonFormat_Optimized</a>); <span class="comment">// {&quot;key1&quot;:4.8}</span></div><div class="line">qDebug() &lt;&lt; value2-&gt;toJson(<a class="code" href="qmjsontype_8h.html#a497c80a5fccb8e63847bf518781be30da68a97f9a51fd9868a5fcc953f179c5db">QMJsonFormat_Optimized</a>); <span class="comment">// {&quot;width&quot;:4,&quot;height&quot;:8,&quot;qmjsontype&quot;:&quot;QSize&quot;}</span></div></div><!-- fragment --><p>If you want to convert a JSON string to it's QtMark JSON representation, you can use the fromJson function:</p>
<div class="fragment"><div class="line"><a class="code" href="class_q_m_json_value.html#a1e3b47a919634655bf10f5c4fa8622cf">QMJsonValue::registerFromComplexJson</a>(<span class="stringliteral">&quot;QSize&quot;</span>, &amp;<a class="code" href="class_q_m_json_type.html">QMJsonType&lt;QSize&gt;::fromComplexJson</a>);</div><div class="line"></div><div class="line"><span class="keyword">auto</span> <span class="keywordtype">object</span> = QMPointer&lt;QMJsonObject&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_object.html">QMJsonObject</a>);</div><div class="line"><span class="keyword">auto</span> value1 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(<span class="keywordtype">object</span>));</div><div class="line"><span class="keyword">auto</span> value2 = QMPointer&lt;QMJsonValue&gt;(<span class="keyword">new</span> <a class="code" href="class_q_m_json_value.html">QMJsonValue</a>(QSize(4, 8)));</div><div class="line"></div><div class="line"><span class="keywordtype">object</span>-&gt;insert(<span class="stringliteral">&quot;key1&quot;</span>, 4.8);</div><div class="line"></div><div class="line">qDebug() &lt;&lt; <a class="code" href="class_q_m_json_value.html#aaf5b72ac548d085a0ef47e2eff9a7d4f">QMJsonValue::fromJson</a>(<span class="stringliteral">&quot;{\&quot;key1\&quot;:4.8}&quot;</span>); <span class="comment">// QMJsonValue(QMJsonObject(&quot;key1&quot;,4.8))</span></div><div class="line">qDebug() &lt;&lt; <a class="code" href="class_q_m_json_value.html#aaf5b72ac548d085a0ef47e2eff9a7d4f">QMJsonValue::fromJson</a>(<span class="stringliteral">&quot;{\&quot;width\&quot;:4,\&quot;height\&quot;:8,\&quot;qmjsontype\&quot;:\&quot;QSize\&quot;}&quot;</span>); <span class="comment">// QMJsonValue(QSize(4,8))</span></div></div><!-- fragment --><h3>Further Information</h3>
<p>Each of the QtMark JSON classes are documented. To see more information, please review the following:</p>
<p><a class="el" href="qmjsonvalue.html">QMJsonValue Overview</a> <br />
<a class="el" href="qmjsonarray.html">QMJsonArray Overview</a> <br />
<a class="el" href="qmjsonobject.html">QMJsonObject Overview</a> <br />
</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 2 2015 14:13:34 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
